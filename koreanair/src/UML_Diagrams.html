<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대한항공 관리자 시스템 UML 다이어그램</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #ecf0f1;
            border-left: 5px solid #3498db;
        }
        .diagram-container {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
            overflow-x: auto;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        .info-box {
            background-color: #e8f6ff;
            border: 1px solid #3498db;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .info-box h3 {
            color: #2980b9;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🛫 대한항공 관리자 시스템 UML 다이어그램</h1>

        <div class="info-box">
            <h3>📋 프로젝트 개요</h3>
            <p>이 문서는 대한항공 관리자 시스템의 UML 다이어그램들을 포함하고 있습니다. 
            각 다이어그램은 시스템의 다른 관점을 보여주며, 전체적인 아키텍처와 주요 기능들을 설명합니다.</p>
        </div>

        <h2>1. 패키지 다이어그램 (Package Diagram)</h2>
        <p>시스템의 전체적인 구조와 패키지 간의 의존성을 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
graph TD
    subgraph com_koreanair["com.koreanair"]
        subgraph controller["controller"]
            C1["DispatcherServlet"]
            C2["BookingLookupServlet"]
            C3["LoginController"]
        end
        
        subgraph command["command"]
            CM1["CommandHandler Interface"]
            CM2["HomeHandler"]
            CM3["LoginHandler"]
            CM4["BookingHandler"]
            CM5["FlightScheduleHandler"]
            CM6["ReservationsHandler"]
            CM7["PaymentVerifyHandler"]
            CM8["AdminPage Handlers"]
        end
        
        subgraph model["model"]
            subgraph service["service"]
                S1["AuthService"]
                S2["BookingService"]
                S3["PaymentVerifyService"]
                S4["FlightScheduleService"]
                S5["UserService"]
                S6["AdminPage Services"]
            end
            
            subgraph dao["dao"]
                D1["ProjectDao"]
                D2["FlightDAO"]
                D3["AirportDAO"]
                D4["AdminDAO"]
            end
            
            subgraph dto["dto"]
                DT1["User"]
                DT2["AdminReservationDTO"]
                DT3["FlightDTO"]
                DT4["PaymentDTO"]
                DT5["BookingDTO"]
            end
        end
        
        subgraph filter["filter"]
            F1["AuthenticationFilter"]
            F2["EncodingFilter"]
        end
        
        subgraph util["util"]
            U1["DBConnection"]
            U2["KakaoApiService"]
            U3["KakaoConfig"]
        end
    end
    
    subgraph external["External APIs"]
        EXT1["Flight Schedule API"]
        EXT2["Kakao Pay API"]
        EXT3["Kakao Login API"]
    end
    
    subgraph database["Database"]
        DB1["Oracle Database"]
    end
    
    subgraph web["Web Layer"]
        WEB1["Admin JSP Pages"]
        WEB2["User JSP Pages"]
        WEB3["CSS/JS Resources"]
    end
    
    controller --> command
    command --> service
    service --> dao
    service --> dto
    dao --> util
    dao --> dto
    filter --> util
    util --> EXT1
    util --> EXT2
    util --> EXT3
    util --> DB1
    WEB1 --> controller
    WEB2 --> controller
            </div>
        </div>

        <h2>2. 유스케이스 다이어그램 (Use Case Diagram)</h2>
        <p>관리자가 수행할 수 있는 주요 기능들을 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph system["대한항공 관리자 시스템"]
        UC1["대시보드 통계 조회"]
        UC2["항공편 스케줄 관리"]
        UC3["실시간 항공편 동기화"]
        UC4["항공편 좌석 관리"]
        UC5["좌석 가격 설정"]
        UC6["예약 검색 및 조회"]
        UC7["예약 상태 관리"]
        UC8["사용자 검색"]
        UC9["사용자 정보 조회"]
        UC10["수익 통계 분석"]
        UC11["인기 노선 분석"]
        UC12["월별 예약 통계"]
        UC13["DB 데이터 저장"]
        UC14["외부 API 연동"]
    end
    
    ADMIN["관리자<br/>(Administrator)"]
    
    ADMIN --> UC1
    ADMIN --> UC2
    ADMIN --> UC3
    ADMIN --> UC4
    ADMIN --> UC5
    ADMIN --> UC6
    ADMIN --> UC7
    ADMIN --> UC8
    ADMIN --> UC9
    ADMIN --> UC10
    ADMIN --> UC11
    ADMIN --> UC12
    ADMIN --> UC13
            </div>
        </div>

        <h2>3. 컴포넌트 다이어그램 (Component Diagram)</h2>
        <p>시스템의 계층별 컴포넌트 구성과 의존성을 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph presentation["Presentation Layer"]
        UI1["Admin JSP Pages<br/>(adminindex.jsp, flightmanagement.jsp,<br/>reservationManagement.jsp, etc.)"]
        UI2["CSS & JavaScript<br/>(Bootstrap, Chart.js, Custom JS)"]
        UI3["Static Resources<br/>(Images, Fonts)"]
    end
    
    subgraph web["Web Layer"]
        WEB1["DispatcherServlet<br/>(Front Controller)"]
        WEB2["AuthenticationFilter<br/>(Security)"]
        WEB3["EncodingFilter<br/>(UTF-8)"]
    end
    
    subgraph command_layer["Command Layer"]
        CMD1["Admin Command Handlers<br/>(FlightScheduleHandler,<br/>ReservationsHandler, etc.)"]
        CMD2["User Command Handlers<br/>(LoginHandler, BookingHandler, etc.)"]
        CMD3["Payment Command Handlers<br/>(PaymentVerifyHandler, etc.)"]
    end
    
    subgraph service_layer["Service Layer"]
        SVC1["Admin Services<br/>(FlightScheduleService,<br/>ReservationService, etc.)"]
        SVC2["User Services<br/>(AuthService, BookingService, etc.)"]
        SVC3["Payment Services<br/>(PaymentVerifyService, etc.)"]
    end
    
    subgraph data_layer["Data Access Layer"]
        DAO1["ProjectDAO<br/>(Admin Operations)"]
        DAO2["FlightDAO<br/>(Flight Operations)"]
        DAO3["UserDAO<br/>(User Operations)"]
    end
    
    subgraph util_layer["Utility Layer"]
        UTIL1["DBConnection<br/>(Connection Pool)"]
        UTIL2["KakaoApiService<br/>(External API)"]
    end
    
    subgraph external_systems["External Systems"]
        EXT1["Flight Schedule API<br/>(Real-time Data)"]
        EXT2["Kakao Pay API<br/>(Payment Gateway)"]
        EXT3["Kakao Login API<br/>(OAuth)"]
    end
    
    subgraph db_layer["Database"]
        DB1["Oracle Database<br/>(User, Flight, Booking Data)"]
    end
    
    UI1 --> WEB1
    UI2 --> UI1
    UI3 --> UI1
    
    WEB1 --> CMD1
    WEB1 --> CMD2
    WEB1 --> CMD3
    WEB2 --> WEB1
    WEB3 --> WEB1
    
    CMD1 --> SVC1
    CMD2 --> SVC2
    CMD3 --> SVC3
    
    SVC1 --> DAO1
    SVC2 --> DAO2
    SVC2 --> DAO3
    SVC3 --> DAO1
    
    DAO1 --> UTIL1
    DAO2 --> UTIL1
    DAO3 --> UTIL1
    
    UTIL1 --> DB1
    UTIL2 --> EXT1
    UTIL2 --> EXT2
    UTIL2 --> EXT3
    
    SVC1 --> UTIL2
    SVC3 --> UTIL2
            </div>
        </div>

        <h2>4. 클래스 다이어그램 (Class Diagram)</h2>
        <p>핵심 도메인 모델과 DTO 클래스들 간의 관계를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
classDiagram
    class User {
        -String userId
        -String korean_name
        -String email
        -String phone
        -String birth_date
        +getUserId() String
        +getKorean_name() String
        +getEmail() String
    }
    
    class AdminReservationDTO {
        -String booking_id
        -String user_name
        -String email
        -String phone
        -String start
        -String end
        -String status
        -String seat_class
        -int passenger
        -int totalPrice
        +getBooking_id() String
        +getUser_name() String
    }
    
    class FlightDTO {
        -String flight_id
        -String flightNO
        -String departure_airport_id
        -String arrival_airport_id
        +getFlight_id() String
        +getFlightNO() String
    }
    
    class AirportDTO {
        -String airportId
        -String airportName
        -String cityKor
        -String cityEng
        +getAirportId() String
        +getAirportName() String
    }
    
    class FlightSeatDTO {
        -String seat_id
        -String flight_id
        -String seat_number
        -String class_id
        -boolean is_available
        +getSeat_id() String
        +getFlight_id() String
    }
    
    class PaymentVerifyDTO {
        -String imp_uid
        -String merchant_uid
        -int amount
        -String status
        +getImp_uid() String
        +getMerchant_uid() String
    }
    
    User "1" --> "0..*" AdminReservationDTO : makes
    FlightDTO "1" --> "0..*" FlightSeatDTO : contains
    AdminReservationDTO "0..*" --> "1" FlightDTO : for
    PaymentVerifyDTO "1" --> "1" AdminReservationDTO : payment
            </div>
        </div>

        <h2>5. 시퀀스 다이어그램 - 항공편 스케줄 동기화</h2>
        <p>외부 API를 통한 항공편 스케줄 동기화 프로세스를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant Admin as 관리자
    participant JSP as FlightManagement.jsp
    participant Handler as FlightScheduleHandler
    participant Service as FlightScheduleService
    participant DAO as ProjectDaoImpl
    participant API as External Flight API
    participant DB as Database
    
    Admin->>JSP: 항공편 동기화 버튼 클릭
    JSP->>Handler: /syncDataBtn 요청
    
    Handler->>Service: fetchFlightData(apiUrl)
    Service->>API: HTTP GET 요청
    API-->>Service: XML 응답 데이터
    Service-->>Handler: 파싱된 항공편 데이터
    
    Handler->>Service: saveSchedulesDB(scheduleList)
    Service->>DAO: saveSchdulesDB(scheduleList)
    
    loop 각 항공편 데이터
        DAO->>DB: INSERT INTO flight
        DB-->>DAO: 저장 결과
    end
    
    DAO-->>Service: 저장 완료
    Service-->>Handler: 성공 응답
    Handler-->>JSP: JSON 응답
    JSP-->>Admin: 동기화 완료 메시지
            </div>
        </div>

        <h2>6. 시퀀스 다이어그램 - 예약 검색 및 조회</h2>
        <p>예약 정보 검색 및 조회 프로세스를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant Admin as 관리자
    participant JSP as ReservationManagement.jsp
    participant Handler as ReservationsHandler
    participant Service as ReservationService
    participant DAO as ProjectDaoImpl
    participant DB as Database
    
    Admin->>JSP: 검색 조건 입력 및 검색 버튼 클릭
    JSP->>Handler: /reservations.wi 요청 (searchType, searchKeyword, status)
    
    Handler->>Service: reservation(searchType, searchKeyword, status)
    Service->>DAO: reservations(searchType, searchKeyword, status)
    
    DAO->>DB: SELECT with JOIN (booking, users, flight, airport, booking_status)
    DB-->>DAO: 예약 데이터 ResultSet
    
    loop 각 예약 레코드
        DAO->>DAO: AdminReservationDTO 생성
    end
    
    DAO-->>Service: List AdminReservationDTO
    Service-->>Handler: 예약 목록
    Handler-->>JSP: JSON 응답
    JSP-->>Admin: 검색 결과 테이블 표시
            </div>
        </div>

        <h2>7. 시퀀스 다이어그램 - 좌석 관리</h2>
        <p>항공편 좌석 배치 및 관리 프로세스를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant Admin as 관리자
    participant JSP as SeatManagement.jsp
    participant SaveHandler as FlightSeatSaveHandler
    participant LoadHandler as FlightSeatLoadHandler
    participant Service as FlightSeatSaveService
    participant DAO as ProjectDaoImpl
    participant DB as Database
    
    Admin->>JSP: 항공편 선택
    JSP->>LoadHandler: /seatload.wi 요청 (flight_id)
    
    LoadHandler->>DAO: flightSeatload(flight_id)
    DAO->>DB: SELECT flight_seat WHERE flight_id = ?
    DB-->>DAO: 좌석 데이터
    DAO-->>LoadHandler: List FlightSeatSaveDTO
    LoadHandler-->>JSP: 좌석 배치도 데이터
    JSP-->>Admin: 좌석 배치도 표시
    
    Admin->>JSP: 좌석 배치 수정 및 저장
    JSP->>SaveHandler: /seatsave.wi 요청 (seatList, flight_id)
    
    SaveHandler->>Service: checkDuplicateSeat(seatList)
    Service->>DAO: checkDuplicateSeat(seatList)
    DAO->>DB: SELECT 중복 체크
    DB-->>DAO: 중복 여부
    DAO-->>Service: 중복 체크 결과
    Service-->>SaveHandler: 검증 완료
    
    SaveHandler->>DAO: seatsave(seatList, flight_id)
    
    loop 각 좌석
        DAO->>DB: INSERT UPDATE flight_seat
        DB-->>DAO: 저장 결과
    end
    
    DAO-->>SaveHandler: 저장 완료
    SaveHandler-->>JSP: 성공 응답
    JSP-->>Admin: 저장 완료 메시지
            </div>
        </div>

        <h2>8. 시퀀스 다이어그램 - 대시보드 통계 조회</h2>
        <p>대시보드의 다양한 통계 데이터를 병렬로 로딩하는 프로세스를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant Admin as 관리자
    participant JSP as AdminIndex.jsp
    participant StatsHandler as DashBoardStatsHandler
    participant RevenueHandler as SeatRevenueHandler
    participant MonthHandler as MonthReservationHandler
    participant PopularHandler as PopularHandler
    participant DAO as ProjectDaoImpl
    participant DB as Database
    
    Admin->>JSP: 대시보드 페이지 접속
    
    par 통계 데이터 병렬 로딩
        JSP->>StatsHandler: /dashboardstats.wi 요청
        StatsHandler->>DAO: dashLoad()
        DAO->>DB: SELECT 전체 통계
        DB-->>DAO: 사용자, 예약 통계
        DAO-->>StatsHandler: DashBoardStatsDTO
        StatsHandler-->>JSP: 기본 통계 JSON
    and
        JSP->>RevenueHandler: /seatrevenue.wi 요청
        RevenueHandler->>DAO: seatRevenue()
        DAO->>DB: SELECT 좌석별 수익
        DB-->>DAO: 좌석 수익 데이터
        DAO-->>RevenueHandler: SeatRevenueDTO List
        RevenueHandler-->>JSP: 수익 통계 JSON
    and
        JSP->>MonthHandler: /monthlyreservations.wi 요청
        MonthHandler->>DAO: monthReservation(year)
        DAO->>DB: SELECT 월별 예약 수
        DB-->>DAO: 월별 데이터
        DAO-->>MonthHandler: MonthReservationDTO List
        MonthHandler-->>JSP: 월별 통계 JSON
    and
        JSP->>PopularHandler: /popularroutes.wi 요청
        PopularHandler->>DAO: popularroutes(year)
        DAO->>DB: SELECT 인기 노선
        DB-->>DAO: 노선별 예약 수
        DAO-->>PopularHandler: PopularDTO List
        PopularHandler-->>JSP: 인기 노선 JSON
    end
    
    JSP-->>Admin: 대시보드 차트 및 통계 표시
            </div>
        </div>

        <h2>9. 액티비티 다이어그램 (Activity Diagram)</h2>
        <p>관리자의 항공편 관리 워크플로우를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
flowchart TD
    START([관리자 항공편 관리 시작])
    LOGIN{로그인 확인}
    MENU[항공편 관리 메뉴 선택]
    
    subgraph sync["실시간 데이터 동기화"]
        SYNC[동기화 버튼 클릭]
        API_CALL[외부 API 호출]
        DATA_PARSE[XML 데이터 파싱]
        VALIDATE[데이터 유효성 검사]
        SAVE_DB[데이터베이스 저장]
        SYNC_SUCCESS[동기화 완료]
    end
    
    subgraph seat["좌석 관리"]
        SELECT_FLIGHT[항공편 선택]
        LOAD_SEATS[기존 좌석 배치 로드]
        MODIFY_SEATS[좌석 배치 수정]
        SET_PRICES[좌석 가격 설정]
        VALIDATE_SEATS[좌석 중복 검사]
        SAVE_SEATS[좌석 정보 저장]
        SEAT_SUCCESS[좌석 설정 완료]
    end
    
    subgraph schedule["스케줄 조회"]
        DATE_SELECT[날짜 선택]
        FILTER_TYPE[필터 유형 선택]
        LOAD_SCHEDULE[스케줄 조회]
        DISPLAY_RESULT[결과 표시]
    end
    
    ERROR[오류 처리]
    END([프로세스 종료])
    
    START --> LOGIN
    LOGIN -->|인증 실패| ERROR
    LOGIN -->|인증 성공| MENU
    
    MENU --> SYNC
    MENU --> SELECT_FLIGHT
    MENU --> DATE_SELECT
    
    SYNC --> API_CALL
    API_CALL --> DATA_PARSE
    DATA_PARSE --> VALIDATE
    VALIDATE -->|유효하지 않음| ERROR
    VALIDATE -->|유효함| SAVE_DB
    SAVE_DB --> SYNC_SUCCESS
    
    SELECT_FLIGHT --> LOAD_SEATS
    LOAD_SEATS --> MODIFY_SEATS
    MODIFY_SEATS --> SET_PRICES
    SET_PRICES --> VALIDATE_SEATS
    VALIDATE_SEATS -->|중복 발견| ERROR
    VALIDATE_SEATS -->|유효함| SAVE_SEATS
    SAVE_SEATS --> SEAT_SUCCESS
    
    DATE_SELECT --> FILTER_TYPE
    FILTER_TYPE --> LOAD_SCHEDULE
    LOAD_SCHEDULE --> DISPLAY_RESULT
    
    SYNC_SUCCESS --> END
    SEAT_SUCCESS --> END
    DISPLAY_RESULT --> END
    ERROR --> END
            </div>
        </div>

        <h2>10. 배치 다이어그램 (Deployment Diagram)</h2>
        <p>시스템의 물리적인 배포 구조와 인프라를 보여줍니다.</p>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph client["Client Tier"]
        CLIENT["Web Browser<br/>(Chrome, Safari, Edge)<br/>- Admin Interface<br/>- JavaScript/CSS"]
    end
    
    subgraph tomcat["Web Tier - Tomcat Server"]
        TOMCAT["Apache Tomcat 9.x<br/>- JSP Engine<br/>- Servlet Container"]
        
        subgraph webapp["Web Applications"]
            WEBAPP["KoreanAir Admin App<br/>- JSP Pages<br/>- Static Resources<br/>- WEB-INF"]
        end
        
        subgraph java_comp["Java Components"]
            SERVLET["Servlets<br/>- DispatcherServlet<br/>- BookingLookupServlet"]
            FILTER["Filters<br/>- AuthenticationFilter<br/>- EncodingFilter"]
            HANDLERS["Command Handlers<br/>- Admin Handlers<br/>- User Handlers"]
        end
    end
    
    subgraph app_tier["Application Tier - Business Logic"]
        SERVICES["Service Layer<br/>- FlightScheduleService<br/>- ReservationService<br/>- PaymentService"]
        DAO["Data Access Layer<br/>- ProjectDAO<br/>- FlightDAO<br/>- UserDAO"]
    end
    
    subgraph db_tier["Database Tier"]
        ORACLE["Oracle Database<br/>- User Tables<br/>- Flight Tables<br/>- Booking Tables<br/>- Payment Tables"]
        POOL["Connection Pool<br/>(JNDI DataSource)"]
    end
    
    subgraph ext_services["External Services"]
        FLIGHT_API["Flight Schedule API<br/>(Real-time Data)"]
        KAKAO_PAY["Kakao Pay API<br/>(Payment Gateway)"]
        KAKAO_LOGIN["Kakao Login API<br/>(OAuth 2.0)"]
    end
    
    CLIENT -.->|HTTPS/HTTP| TOMCAT
    TOMCAT --> WEBAPP
    WEBAPP --> SERVLET
    WEBAPP --> FILTER
    WEBAPP --> HANDLERS
    
    SERVLET --> SERVICES
    FILTER --> SERVICES
    HANDLERS --> SERVICES
    
    SERVICES --> DAO
    DAO --> POOL
    POOL --> ORACLE
    
    SERVICES -.->|HTTPS/REST| FLIGHT_API
    SERVICES -.->|HTTPS/REST| KAKAO_PAY
    SERVICES -.->|HTTPS/OAuth| KAKAO_LOGIN
    
    TOMCAT -.->|"Deploy WAR"| WEBAPP
    ORACLE -.->|"JDBC Driver"| POOL
            </div>
        </div>

        <div class="info-box">
            <h3>🌐 외부에서 보는 방법들</h3>
            <ol>
                <li><strong>이 HTML 파일:</strong> 브라우저에서 바로 열어서 확인 (추천!)</li>
                <li><strong>Mermaid Live Editor:</strong> <a href="https://mermaid.live/" target="_blank">mermaid.live</a>에서 UML_Diagrams.md 파일의 코드 붙여넣기</li>
                <li><strong>GitHub/GitLab:</strong> UML_Diagrams.md 파일을 업로드하면 자동 렌더링</li>
                <li><strong>Visual Studio Code:</strong> Mermaid Extension 설치 후 .md 파일 미리보기</li>
                <li><strong>Draw.io:</strong> diagrams.net에서 Mermaid 코드 import하여 편집 가능</li>
            </ol>
            
            <h3>🎯 발표 시 활용 가이드</h3>
            <ul>
                <li><strong>기술 아키텍처 설명용:</strong> 패키지 다이어그램 + 컴포넌트 다이어그램</li>
                <li><strong>비즈니스 기능 설명용:</strong> 유스케이스 다이어그램 + 액티비티 다이어그램</li>
                <li><strong>전체적인 프로젝트 이해용:</strong> 유스케이스 → 패키지 → 컴포넌트 → 액티비티 순서로 설명</li>
            </ul>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#3498db',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#2980b9',
                lineColor: '#34495e'
            }
        });
    </script>
</body>
</html> 